<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>コメント</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <div class="login-signup" style="max-width:720px">
    <h1>コメント</h1>

    <div id="note-info" class="small" style="margin:8px 0 16px;color:#555"></div>

    <ul id="comments-list"></ul>

    <!-- formにしない／buttonはtype="button" -->
    <div style="display:flex;align-items:center;gap:8px;">
      <input id="comment-input" class="comment-input" type="text" placeholder="コメントを入力…" />
      <button id="comment-btn" type="button" disabled>投稿</button>
    </div>
    <p id="comment-hint" class="small" style="margin-top:6px;color:#777">
      ※ ログインするとコメントを投稿できます。
    </p>

    <p style="margin-top:18px"><a href="main.html">← 一覧に戻る</a></p>
  </div>

  <!-- ↓↓↓ これを comments.html の一番下に貼る（既存の <script type="module" ...> は消す） -->
<script>
  (async () => {
    const log = (m, o) => { console.log("[BOOT]", m, o||""); };
    const hint = document.getElementById("comment-hint");
    const say  = (m) => { if (hint) hint.textContent = "DEBUG: " + m; };

    try {
      log("DOM ready", {
        list:  !!document.getElementById("comments-list"),
        input: !!document.getElementById("comment-input"),
        btn:   !!document.getElementById("comment-btn"),
        hint:  !!hint,
      });
      say("booting…");

      // ① supabase.js を先に
      await import("./js/supabase.js?v=boot1");
      log("supabase.js imported");
      say("supabase loaded");

      // ② comments.js を動的読み込み（失敗時のエラーを可視化）
      await import("./js/comments.js?v=boot1");
      log("comments.js imported OK");
      say("comments.js loaded OK");
    } catch (e) {
      console.error("IMPORT FAILED:", e);
      alert("comments.js import error: " + (e && e.message));
      say("import error: " + (e && e.message));
    }
  })();
</script>

</body>
</html>
