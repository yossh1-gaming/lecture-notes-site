<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>æ–°ç€ãŠçŸ¥ã‚‰ã›</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body style="max-width:760px;margin:30px auto;">
  <h1>æ–°ç€ãŠçŸ¥ã‚‰ã›</h1>
  <p><a href="main.html">â† ä¸€è¦§ã«æˆ»ã‚‹</a></p>
  <ul id="news"></ul>

  <script type="module">
    import { supabase } from "./js/supabase.js";
    const ul = document.getElementById("news");
    const { data, error } = await supabase
      .from("notes")
      .select("id, title, created_at, user_id, profiles:profiles(username)")
      .order("created_at", { ascending: false })
      .limit(30);
    if (error) {
      ul.innerHTML = "<li>èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</li>";
    } else {
      ul.innerHTML = "";
      (data || []).forEach(n => {
        const name = n.profiles?.username || "åç„¡ã—";
        const li = document.createElement("li");
        li.innerHTML = `ğŸ“° ${new Date(n.created_at).toLocaleString()} â€” <strong>${n.title}</strong>ï¼ˆæŠ•ç¨¿è€…ï¼š${name}ï¼‰ <a href="comments.html?note_id=${n.id}">ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã‚‹</a>`;
        ul.appendChild(li);
      });
    }
  </script>
</body>
</html>
