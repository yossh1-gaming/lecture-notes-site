<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>メール認証完了</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <div class="container">
    <h1>メール認証中…</h1>
    <p id="status">しばらくお待ちください。</p>
    <p><a href="index.html">ログイン画面へ戻る</a></p>
  </div>

  <!-- confirm.html の <body> 終わりに -->
  <script type="module">
    import { supabase } from "./js/supabase.js";
    const hash = new URL(location.href).hash;
    const p = new URLSearchParams(hash.slice(1));
    const at = p.get("access_token");
    const rt = p.get("refresh_token");
    const out = document.getElementById("result");
    if (at && rt) {
      const { error } = await supabase.auth.setSession({ access_token: at, refresh_token: rt });
      out.textContent = error ? "認証失敗：" + error.message : "メール認証が完了しました。";
      setTimeout(()=>location.replace("main.html"), 1500);
    } else {
      out.textContent = "無効なリンクです。";
    }
    </script>


</body>
</html>
